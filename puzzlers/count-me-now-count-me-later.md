## Count Me Now, Count Me Later

```scala
var x = 0
def counter = 
  x += 1
  x
def add(a: Int)(b: Int) = a + b
val adder1 = add(counter)(_)
val adder2 = add(counter) _
println("x = " + x)
// x = 1
println(adder1(10))
// 12
println("x = " + x)
// x = 2
println(adder2(10))
// 11
println("x = " + x)
// x = 2
```

`f(a) _` и `f(a)(_)` имеют разные значения, регулируемые разными разделами спецификации языка Scala. 

`f(a)(_)` — это синтаксис заполнителя для анонимных функций, описанный в SLS §6.23. Вычисление отложено. 

`f(a) _` является eta-расширением, описанным в SLS §6.26.5. 
Приведенные аргументы вычисляются по готовности; откладывается только сам вызов метода. 

В этом примере eta-расширение в `val adder2 = add(counter) _` 
вызывает немедленного вычисление, как описано: 
как только эта строка запускается, Scala фактически вычисляет счетчик 
и привязывает результат `1` к аргументу счетчика для `adder2`. 
Следовательно, `x` равно `1` при первом выводе. 
`adder1`, с другой стороны, является анонимной функцией, 
поэтому ее аргумент-счетчик связан только при вычислении `adder1`. 
Поскольку в этот момент `x` уже равен `1`, счетчик будет равен `2`, а вычисление `adder1` выведет `12`. 
Значение `x` теперь равно `2`, как показано в выводе программы.


---

**References:**
- [Scala Puzzlers](https://scalapuzzlers.com/index.html#pzzlr-022)
